<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Hosted meta Tags -->
    <meta name="branch:deeplink:cameFromWeb" content="true" />
    <!-- <meta name="branch:deeplink:random" content="true" /> -->


    <title>SDK integration test</title>

    <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TX9WT7V');</script>
    <!-- End Google Tag Manager -->

    <script>


        // load Branch
        (function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent disableTracking".split(" "), 0);
        // init Branch
        branch.init('key_live_lmRDylfddV4woXoieOYMeokgurj7kgy4', function (err, data) {
            console.log(err, data);
        });
    </script>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TX9WT7V"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div style="margin:auto; width:50%; padding:10px">
        <button id="customEvent">Log a custom event</button>
        <button id="lifecycleEvent">Log a lifecycle event</button>
    </div>

test
    <script>
        // Add a dynamic Meta tag at a 50% random chance
        // Used to show a different Journey
        if (Math.random() > 0.5){
            console.log("Lucky!")
            var link = document.createElement('meta');
            link.setAttribute('name', 'branch:deeplink:random');
            link.content = "true";
            document.getElementsByTagName('head')[0].appendChild(link);
        }
        

        // Log event functions
        function logCustomEvent() {
            var custom_data = { "btnClicked": "Log a custom event" };

            branch.logEvent(
                "btn_click",
                custom_data,
                function (err) { console.log(err); }
            );
        }

        function logLifecycleEvent() {

            var event_and_custom_data = {
                "transaction_id": "tras_Id_1234",
                "description": "Preferred purchase",
                "registration_id": "12345"
            };

            var customer_event_alias = "clicked btn";

            branch.logEvent(
                "COMPLETE_REGISTRATION",
                event_and_custom_data,
                [],
                customer_event_alias,
                function (err) { console.log(err); }
            );
        }

        // Event listeners for buttons
        let customEventBtn = document.getElementById("customEvent");
        customEventBtn.addEventListener('click', event => {
            logCustomEvent();
        });

        let lifecycleEventBtn = document.getElementById("lifecycleEvent");
        lifecycleEventBtn.addEventListener('click', event => {
            logLifecycleEvent();
        });
    </script>
</body>

</html>
